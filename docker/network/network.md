## 가상 네트워크

* 서버 한대 안에서 여러 네트워크 구성

#### 도커 설치 실행 시
1. 가상의 네트워크 브릿지 생성 
    * 브릿지는 172.17.0.1의 가상의 ip 주소 할당 
2. 컨테이너에 가상의 IP 할당 
   * 공유기에 연결된 기기 한 대에 사설 IP가 할당되는 것과 동일 
3. 컨테이너간의 통신 전달

SDN (Software Defined Network): 논리적으로 네트워크 환경을 구성

#### 동작 원리
1. 물리 인터페이스에 랜선을 연결해 IP 할당 
2. Host OS위에 Docker 설치하면 가상 인터페이스 하나 생성 
3. 컨테이너 실행시 각각 컨테이너에 해당하는 Veth라는 접두어로 Host Os에 가상 인터페이스들이 생성됨

* iptables: Linux 내부의 네트워크 트래픽 관리 및 제어 
  * Rule: 도착지가 172.17.0.3이면 Veth2 인터페이스로 전달
* 컨테이너 1개 당 Host머신에 가상의 Veth 인터페이스 1개 생성
* Docker가 iptables의 규칙을 수정하여 Veth 인터페이스의 트래픽 제어

```
docker network ls - 네트워크 리스트 조회
docker network inspect 네트워크명 - 네트워크 상세 정보 조회
docker network create 네트워크명 - 네트워크 생성
docker network rm 네트워크명 - 네트워크 삭제
```

#### 정리
도커는 컨테이너 통신을 위해 브릿지 네트워크를 정의하고 Host OS의 가상 인터페이스를 생성하고 Host OS의 iptables 규칙을 관리하면서 가상 인터페이스들간 통신 규칙을 생성한다.
-> 사용자는 별도의 설정을 하지 않아도 같은 브릿지 네트워크에서 생성된 컨테이너들은 통신 가능한 상태로 구성됨