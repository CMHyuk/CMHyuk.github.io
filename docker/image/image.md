### 이미지
도커 목적 = 가상화 서버를 빠르고 가볍게 운영하기 위해 사용

이미지 = 특정 서버를 실행할 수 있는 저장한 압축 파일  
* os, 의존 요소, 소프트웨어가 포함되어 있는 압축파일  
* 호스트 OS안에서 격리된 컨테이너가 만들어지고 실행됨

### 이미지와 컨테이너
프로그램  
* 실행 가능한 소프트웨어
* 디스크 공간 차지 

프로세스  
* 실행 상태의 소프트웨어  
* 프로그램 1 : N 프로세스  
* 실행 시 CPU, MEM 등의 리소스 사용  

이미지  
* 실행 가능한 소프트웨어 + 실행에 필요한 환경  
* 디스크 공간 차지

컨테이너  
* 실행 상태의 이미지
* 이미지 1 : N 컨테이너  
* 컨테이너로 실행 시  CPU, MEM 등의 리소스 사용  
* 컨테이너 간 리소스 격리  
* 실행 시 이미지를 복사해 격리된 디스크 공간 생성  
* 컨테이너 실행 시 프로세스도 함께 실행

`docker image ls (이미지명)` - 로컬 이미지 조회  

`docker run -d --name {컨테이너 명} 이미지명`  
* -d : 백그라운드 실행 
* --name {컨테이너 명} : 컨테이너 이름 지정

`docker ps` - 실행 중인 컨테이너 리스트 조회

`docker rm -f` - 실행 중인 컨테이너 삭제

### 이미지와 메타데이터
ENV = 소프트웨어가 실행 시 참조할 설정 정보

CMD = 컨테이너 실행 시 프로세스 실행 명령어 지정

`docker image inspect 이미지명` - 이미지의 세부 정보 조회

`docker container inspect 컨테이너명` - 컨테이너의 세부 정보 조회

`docker run 이미지명 (실행명령)` - 컨테이너 실행 시 메타데이터의 cmd 덮어쓰기

`docker run --env KEY=VALUE 이미지명` - 컨테이너 실행 시 메타데이터의 env 덮어쓰기

`docker ps -a` - 종료된 컨테이너 포함 모든 컨테이너 조회

### 이미지 레지스트리
이미지 레지스트리

* 이미지를 저장하는 저장소

* 이미지 공유, 검색, 버전 관리, 보안, 파이프라인

저장 공간

* 퍼블릭 레지스트리

* 프라이빗 레즈스트리

* 호스트 머신의 로컬 스토리지

동작 과정

1. docker run nginx

2. 로컬 스토리지의 이미지 검색

3. (스토리지에 이미지가 없으면) 레지스트리의 이미지 다운로드

이미지 명 규칙   
* 레지스트리주소/프로젝트명/이미지명:이미지태그  
```docker run -d -p 80:80 --name hellonginx nginx```

## 이미지 레이어

이미지는 레이어드 파일 시스템으로 구성되어 있음  
- 재사용하기 유리  
- 효율적인 데이터 저장과 전송

이미지의 레이어는 이전 레이어의 변경 사항이 저장  
컨테이너 실행 시 읽기, 쓰기 가능한 새로운 레이어 추가

컨테이너 레이어 - 읽기/쓰기 레이어  
이미지 레이어 - 읽기 전용 레이어

```docker image history 이미지명``` - 이미지의 레이어 이력 조회

레이어 방식은 중복 데이터를 최소화하고, 빌드 속도를 높이며, 저장소를 효율적으로 사용할 수 있게 해준다.